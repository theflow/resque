#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path(File.dirname(__FILE__) + '/../lib')
require 'vegas'
require 'resque/server'


Vegas::Runner.new(Resque::Server, 'resque-web', {
  :resque_config => lambda {|v| 
    path = (ENV['RESQUECONFIG'] || v.args.first).strip
    if path && path != '' && path = File.expand_path(path)
      if File.file?(path)
        load path
      else 
        abort "** Can't find #{path}"
      end
    end
    path
  }
})